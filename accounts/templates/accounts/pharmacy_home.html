{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pharmacy Dashboard - {{ pharmacy_name }}</title>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
  <style>
    :root{ --sidebar-w:260px; --transition:.25s ease; }
    html,body{ height:100%; margin:0; background:#f8fafc; }
    
    .app{ 
      height:100vh; width:100vw; display:grid; 
      grid-template-columns:var(--sidebar-w) 1fr; 
      transition:var(--transition); overflow:hidden; 
    }
    .app.is-collapsed{ grid-template-columns:72px 1fr; }
    
    /* Sidebar Styles */
    .sidebar{ 
      background:#fff; border-right:1px solid var(--line); 
      display:flex; flex-direction:column; overflow:hidden; 
      transition:var(--transition); 
    }
    .brand{ 
      display:flex; align-items:center; gap:.6rem; 
      padding:1rem; border-bottom:1px solid var(--line); 
    }
    .brand .logo{ 
      width:36px; height:36px; border-radius:10px; 
      display:grid; place-items:center; 
      background:linear-gradient(135deg,#10b981,#059669); 
      color:#fff; font-weight:800; 
    }
    .brand h1{ font-size:1.05rem; margin:0; letter-spacing:.2px; }
    
    .side-section{ padding:.75rem 1rem; flex:1; overflow-y:auto; }
    .side-title{ 
      font-size:.8rem; font-weight:800; 
      color:var(--ink-dim); margin:.4rem 0 .3rem; 
      text-transform:uppercase; letter-spacing:.5px;
    }
    .nav{ display:flex; flex-direction:column; gap:.4rem; }
    .nav a{ 
      display:flex; align-items:center; gap:.55rem; 
      padding:.7rem .6rem; border-radius:10px; 
      color:var(--ink); text-decoration:none; 
      border:1px solid transparent; transition:.15s;
      font-weight:600;
    }
    .nav a:hover{ background:#f1f5f9; border-color:var(--line); }
    .nav a.primary{ 
      background:linear-gradient(135deg,#10b981,#059669); 
      color:#fff; font-weight:700;
    }
    .nav a.primary:hover{ filter:brightness(1.05); }
    
    .collapse-btn{ border-top:1px solid var(--line); padding:.6rem 1rem; }
    .collapse-btn button{ 
      width:100%; border:1px solid var(--line); 
      background:#fff; color:var(--ink); padding:.6rem; 
      border-radius:10px; cursor:pointer; font-weight:700; 
      transition:.15s;
    }
    .collapse-btn button:hover{ background:#f8fafc; }
    
    .app.is-collapsed .brand h1, 
    .app.is-collapsed .side-title, 
    .app.is-collapsed .nav a span.label{ display:none; }
    .app.is-collapsed .nav a{ justify-content:center; }

    /* Main Content */
    .main{ display:grid; grid-template-rows:auto 1fr; height:100%; overflow:hidden; }
    
    .topbar{ 
      background:#fff; border-bottom:1px solid var(--line); 
      display:flex; align-items:center; justify-content:space-between; 
      gap:1rem; padding:.75rem 1.5rem; 
    }
    .top-left{ display:flex; align-items:center; gap:1rem; }
    .hamburger{ 
      display:none; width:38px; height:38px; 
      border-radius:10px; border:1px solid var(--line); 
      background:#fff; cursor:pointer; 
    }
    .top-title{ font-weight:800; font-size:1.1rem; color:var(--ink); }
    .top-right{ display:flex; align-items:center; gap:.9rem; }
    .avatar{ 
      width:36px; height:36px; border-radius:999px; 
      display:grid; place-items:center; color:#fff; 
      background:linear-gradient(135deg,#10b981,#059669); 
      font-weight:800; font-size:.9rem;
    }

    /* Content Grid */
    .content{ 
      display:grid; grid-template-columns:2fr 1fr; gap:1.2rem; 
      height:100%; overflow:auto; padding:1.2rem; background:#f8fafc; 
    }
    
    /* Panel Styles - Matching Doctor's Design */
    .panel{ 
      background:#fff; border:1px solid var(--line); 
      border-radius:12px; 
      box-shadow:0 2px 4px rgba(0,0,0,.05); 
      display:flex; flex-direction:column; 
    }
    .panel .head{ 
      padding:.9rem 1rem; border-bottom:1px solid var(--line); 
      display:flex; align-items:center; justify-content:space-between; 
    }
    .panel .head h2{ font-size:1rem; margin:0; font-weight:800; }
    .panel .body{ padding:.9rem 1rem; flex:1; overflow-y:auto; }
    
    /* Medicine List Items - Like Doctor's Appointments */
    .med-list{ display:flex; flex-direction:column; gap:.65rem; }
    .med-item{ 
      border:1px solid var(--line); border-radius:12px; 
      padding:.85rem .9rem; display:flex; 
      justify-content:space-between; align-items:center; 
      gap:.5rem; background:#fff; transition:.15s; 
      text-decoration:none; color:inherit; 
    }
    .med-item:hover{ 
      box-shadow:0 0 0 4px rgba(16,185,129,.15); 
      border-color:#10b981; 
    }
    .med-item .left{ display:flex; align-items:center; gap:.8rem; }
    .med-item .left svg{ color:#10b981; flex-shrink:0; }
    .med-name{ font-weight:800; margin-bottom:.2rem; }
    .med-details{ font-size:.85rem; color:var(--ink-dim); }
    
    /* Pills/Badges */
    .pill{ 
      padding:.2rem .55rem; border-radius:999px; 
      border:1px solid var(--line-2); font-size:.82rem; 
      color:#0b1221; background:#f8fafc; display:inline-block;
      font-weight:600; margin-right:.4rem;
    }
    .pill.green{ 
      background:#d1fae5; color:#065f46; 
      border-color:#6ee7b7; 
    }
    .pill.orange{ 
      background:#fed7aa; color:#92400e; 
      border-color:#fbbf24; 
    }
    .pill.red{ 
      background:#fee2e2; color:#991b1b; 
      border-color:#fca5a5; 
    }
    
    /* Stats Info */
    .stat-info{ 
      display:flex; align-items:center; gap:.35rem; 
      color:var(--ink-dim); font-weight:700; font-size:.9rem;
    }
    
    /* Muted Empty State */
    .muted{ 
      color:var(--ink-dim); text-align:center; 
      padding:1.2rem 0; border:1px dashed var(--line-2); 
      border-radius:12px; background:#f8fafc; 
    }
    
    /* Quick Stats Grid */
    .stats-grid{
      display:grid; grid-template-columns:repeat(2, 1fr);
      gap:.8rem; margin-bottom:1.2rem;
    }
    .stat-box{
      background:#fff; border:1px solid var(--line);
      border-radius:12px; padding:1rem;
      display:flex; align-items:center; gap:.8rem;
    }
    .stat-box .icon{
      width:44px; height:44px; border-radius:10px;
      display:grid; place-items:center;
      background:linear-gradient(135deg,#d1fae5,#a7f3d0);
    }
    .stat-box .icon svg{ color:#059669; }
    .stat-box .info{ flex:1; }
    .stat-box .label{ 
      font-size:.8rem; color:var(--ink-dim); 
      font-weight:700; text-transform:uppercase;
    }
    .stat-box .value{ 
      font-size:1.5rem; font-weight:800; 
      color:var(--ink); margin-top:.1rem;
    }
    
    @media (max-width:1020px){ 
      .content{ grid-template-columns:1fr; } 
      .hamburger{ display:block; } 
      .stats-grid{ grid-template-columns:repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="app" id="appShell">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">RX</div>
        <h1>Medilink</h1>
      </div>
      <div class="side-section">
        <div class="side-title">Quick Actions</div>
        <nav class="nav">
          <a href="{% url 'pharmacy_home' %}" class="primary">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            </svg>
            <span class="label">Dashboard</span>
          </a>
          <a href="{% url 'add_medicine' %}">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="12" y1="18" x2="12" y2="12"></line>
              <line x1="9" y1="15" x2="15" y2="15"></line>
            </svg>
            <span class="label">Add Medicine</span>
          </a>
          <a href="{% url 'update_stock' %}">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
            <span class="label">Update Stock</span>
          </a>
          <a href="{% url 'view_inventory' %}">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 7h16M4 12h16M4 17h10"></path>
            </svg>
            <span class="label">View Full Inventory</span>
          </a>
        </nav>
      </div>
      
      <div class="side-section" style="margin-top:auto; padding-top:0;">
        <div class="side-title">Pharmacist</div>
        <div style="display:flex; align-items:center; gap:.6rem; padding:.6rem; background:#f8fafc; border-radius:10px;">
          <div class="avatar" style="width:32px; height:32px; font-size:.8rem;">AY</div>
          <div style="flex:1; min-width:0;">
            <div style="font-weight:800; font-size:.85rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Ahmad Yateem</div>
            <div style="font-size:.75rem; color:var(--ink-dim);">Head Pharmacist</div>
          </div>
        </div>
      </div>
      
      <div class="collapse-btn">
        <button type="button" id="toggleBtn">Collapse Sidebar</button>
      </div>
    </aside>

    <section class="main">
      <header class="topbar">
        <div class="top-left">
          <button class="hamburger" id="hamburger" aria-label="Toggle sidebar">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
          </button>
          <div class="top-title">Pharmacy Dashboard</div>
        </div>
        <div class="top-right">
          <div class="avatar">AY</div>
          <div>
            <div style="font-weight:800;">Ahmad Yateem</div>
            <small style="color:var(--ink-dim);">{{ today }}</small>
          </div>
        </div>
      </header>

      <div class="content">
        <div class="panel">
          <div class="head">
            <h2>Critical Medicines</h2>
            <a href="{% url 'view_inventory' %}" class="auth-link">View all</a>
          </div>
          <div class="body">
            {% if critical_medicines %}
              <div class="med-list">
                {% for med in critical_medicines %}
                  <a href="{% url 'view_inventory' %}" class="med-item">
                    <div class="left">
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                        <circle cx="12" cy="10" r="3"></circle>
                      </svg>
                      <div>
                        <div class="med-name">{{ med.name }}</div>
                        <div class="med-details">
                          <span class="pill {% if med.quantity <= 5 %}red{% elif med.quantity <= 10 %}orange{% else %}green{% endif %}">
                            {{ med.quantity }} units
                          </span>
                          {{ med.form }} â€¢ {{ med.strength }}
                        </div>
                      </div>
                    </div>
                    <div class="stat-info">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 6v6l4 2"></path>
                      </svg>
                      Exp: {{ med.expiry_date|date:"M d" }}
                    </div>
                  </a>
                {% endfor %}
              </div>
            {% else %}
              <div class="muted">No critical medicines at this time.</div>
            {% endif %}
          </div>
        </div>

        <div class="panel">
          <div class="head">
            <h2>Inventory Stats</h2>
          </div>
          <div class="body">
            <div class="stats-grid">
              <div class="stat-box">
                <div class="icon">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                  </svg>
                </div>
                <div class="info">
                  <div class="label">Total Items</div>
                  <div class="value">{{ total_medicines|default:"0" }}</div>
                </div>
              </div>
              
              <div class="stat-box">
                <div class="icon">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="1" y="3" width="15" height="13"></rect>
                    <path d="M16 8h6v11H6v-3"></path>
                  </svg>
                </div>
                <div class="info">
                  <div class="label">In Stock</div>
                  <div class="value">{{ total_stock_quantity|default:"0" }}</div>
                </div>
              </div>
              
              <div class="stat-box">
                <div class="icon" style="background:linear-gradient(135deg,#fed7aa,#fbbf24);">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color:#92400e;">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                    <line x1="12" y1="9" x2="12" y2="13"></line>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                  </svg>
                </div>
                <div class="info">
                  <div class="label">Low Stock</div>
                  <div class="value">{{ low_stock_count|default:"0" }}</div>
                </div>
              </div>
              
              <div class="stat-box">
                <div class="icon" style="background:linear-gradient(135deg,#fee2e2,#fca5a5);">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color:#991b1b;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="15" y1="9" x2="9" y2="15"></line>
                    <line x1="9" y1="9" x2="15" y2="15"></line>
                  </svg>
                </div>
                <div class="info">
                  <div class="label">Expiring</div>
                  <div class="value">{{ expiring_count|default:"0" }}</div>
                </div>
              </div>
            </div>
            
            <p class="muted" style="border:0; background:transparent; padding:.5rem 0;">
              Last updated: {{ today }}
            </p>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    const app=document.getElementById('appShell');
    const btn=document.getElementById('toggleBtn');
    const burger=document.getElementById('hamburger');
    const toggle=()=>{app.classList.toggle('is-collapsed');btn.textContent=app.classList.contains('is-collapsed')?'Expand Sidebar':'Collapse Sidebar';};
    if(btn) btn.addEventListener('click',toggle);
    if(burger) burger.addEventListener('click',toggle);
  </script>
</body>
</html> 
